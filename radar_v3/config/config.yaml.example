# 기본 SENSR 연결 설정
sensr:
  host: "YOUR_HOST_IP"            # 기본 지점 IP 주소
  active_host_label: "default"
  hosts:
    - id: "site1"
      address: "YOUR_SITE1_IP"
      description: "Site 1"
    - id: "site2"
      address: "YOUR_SITE2_IP"
      description: "Site 2"
  ports:
    output_data: 5050      # 객체, 이벤트 데이터 스트림
    point_cloud: 5051      # 포인트클라우드 데이터 스트림
    logs: 5057             # SENSR 로그 소켓
    rest: 9080             # REST API 포트
  reconnect_interval: 5    # 재연결 시도 주기 (초)
  api:
    # Zone 및 Health API 요청
    cache_timeout: 5       # API 응답 캐시 지속 시간 (초)
    request_timeout: 10    # API 요청 타임아웃 (초)
    # 주요 API 엔드포인트
    endpoints:
      health: "/results/health"
      zones: "/results/zone"
      sensors: "/settings/sensor-ext"
      nodes: "/settings/node"
      projects: "/commands/project"
      apply_changes: "/commands/apply-change"

recording:
  duration: 60             # bag 파일 최대 길이 (초) - 메모리 최적화: 600→60
  output_directory: "./output"
  filename_format: "sensr_data_{timestamp}.bag"
  
  # 데이터 샘플링 주기 (정밀도 제어)
  pointcloud_interval: 1.0 # 포인트클라우드 수집 주기 (초)
  output_data_interval: 1.0 # 객체 데이터 수집 주기 (초)
  
  # 수집 데이터 필터 옵션
  pointcloud_only: false   # true이면 포인트클라우드만 저장
  skip_empty_data: true   # 비어 있는 패킷은 저장하지 않음
  track_log_enabled: true   # 추적 객체 수 변동 시 로그
  
ros:
  topics:
    pointcloud: "/sensr/pointcloud"
    objects: "/sensr/objects"
    events: "/sensr/events"
    health: "/sensr/health"
    zones: "/sensr/zones"

logging:
  level: "INFO"
  file: "./logs/sensr_recorder.log"

# 멀티프로세싱 설정
multiprocessing:
  num_workers: 4                # 워커 프로세스 수
  max_workers: 8                # 최대 워커 수 (적응형 풀)
  input_queue_size: 100         # 입력 큐 크기
  output_queue_size: 1000       # 출력 큐 크기
  scale_up_threshold: 50        # 큐 크기가 이 값 이상이면 워커 추가
  scale_down_seconds: 30        # 이 시간(초) 동안 idle이면 워커 제거

# 큐 백프레셔 설정
queue:
  max_items: 200                # 큐 최대 크기
  high_watermark_pct: 80        # 경고 임계값 (%)
  drop_policy: "oldest"         # 드롭 정책: oldest, pointcloud_only, output_only

# Graceful shutdown 설정
shutdown:
  timeout_s: 10                 # 최대 대기 시간 (초)
  flush_queues: true            # 종료 시 큐 플러시 여부
